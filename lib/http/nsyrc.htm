<!DOCTYPE html>
<html lang=en>
<head>
<title>nsyrc v?.?.?</title>
<style>

/********** Design **********/

body    { font-size: 12px; font-family: monospace; color: #000; background: #222; width: 1000px; margin: 4em auto; }
header  { font-size: 16px; color: #eee; text-shadow: 1px 1px 3px #888; }
section { margin-bottom: 20px; padding: 20px; border-radius: 20px; background-color: #ddd; width: 100%; }
input   { height: 14px; width: 20em; background: #fff; }
h4      { font-size: 16px; margin-top: 0em; margin-bottom: 0em; }
a:link, a:visited, a:active  { color: inherit; text-decoration: none; }
a:hover                      { color: inherit; text-decoration: underline; }
div#output::-webkit-scrollbar { -webkit-appearance: none; width: 7px; }
div#output::-webkit-scrollbar-thumb { border-radius: 4px; background-color: rgba(0,0,0,.5); }
div#output { height: 400px; overflow: scroll; }
span.run, span#clearoutput, span#create, span.editlinks, span.delete { text-decoration: underline; cursor: pointer; font-weight: bold; } /*this should be done better*/

/********** Logic  **********/

section#createlink, span.delete, span.editlinks.back { display: none; }
.folder.exists  { color: #090; }
.folder.remote  { color: #990; }
.folder.missing  { color: #900; }

/********** Dev    **********/

span.editlinks, div#newversion { display: none; }

/****************************/

</style>
<script type='text/javascript' src="http://localhost:8080/socket.io/socket.io.js"></script>
<script type='text/javascript' src="http://localhost:8080/jquery-2.0.3.min.map"></script>
<script type='text/javascript'>

function appendOutput(el, string) {
  var scroll = el.scrollTop / (el.scrollHeight - el.clientHeight);
  $(el).append(string);
  if (isNaN(scroll) || scroll == 1) {
    $(el).scrollTop(el.scrollHeight);
  }
}

$(function() {

  var $toggled = $('section#createlink, section#output, span.run, span.delete, span.editlinks');
  var $output = $('div#output');
  var $titles = $('title, a#title');
  var $links = $('div#links');

  $('span.editlinks').click(function() {
    $toggled.toggle();
  });
  $('span#clearoutput').click(function() {
    $output.html('... ');
  });

  var socket = io.connect('http://localhost:8080');

  socket.on('version', function(data) {
    $titles.html('nsyrc v' + data.version);
  });
  socket.on('links', function(data) {
    $links.html(data.table);
  });
  socket.on('output', function(data) {
    appendOutput($output[0], data.output);
  });

  socket.emit('getVersion');
  socket.emit('getLinks');

  $('span.run').click(function() {
    var id = $(this).attr('id');
    socket.emit('run', { id: id });
  });

  window.onunload = function(){
    socket.emit('exit');
  };

});

</script>
</head>




<body>
<header>
  <h1>
    <a id='title' href='https://npmjs.org/package/nsyrc' target='_blank'>nsyrc v?.?.?</a>
  </h1>
  <div id='newversion'>A new version is now available! Run `npm install -g nsyrc`<br /><br /></div>
</header>

<section>
  <h4>Links</h4>
  <span class='editlinks'>Edit links<br /></span>
  <span class='editlinks back'>Go back<br /></span>
  <br />

  <div id='links'>
    <span class='link'></span>
    <br />
  </div>

</section>

<section id='createlink'>
  <h4>Create link</h4>
  <br />
  From &nbsp;:           <input id='from' size='36' maxlength='32' /> <span class='checking'>Checking...</span><br />
  To &nbsp;&nbsp;&nbsp;: <input id='to'   size='36' maxlength='32' /> <span class='checking'>Checking...</span><br />
  <br />
  <span id='create'>Create!</span>
</section>

<section id='output'>
  <h4>Output</h4>
  <span id='clearoutput'>Clear output</span><br /><br />
  <div id='output'>... </div>
</section>



</body>
</html>
